\documentclass[10pt,a4paper]{article}

%\usepackage[margin=13mm]{geometry}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[font=small,format=plain,labelfont=bf,up,textfont=it,up]{caption}
\usepackage{xcolor}
\usepackage{hyperref}
\usepackage[framemethod=tikz]{mdframed}
\usepackage{tcolorbox}
\usepackage{boites,boiteenv}
\usepackage{fvrb-ex}
\usepackage{tikz}
\usepackage{calc}
\usepackage{pygmentex}
\usepackage{lipsum}

\fvset{gobble=0,frame=lines,framerule=1pt,numbers=left,fontsize=\small}

\tcbuselibrary{skins,breakable}

\definecolor{shadecolor}{rgb}{0.9,0.9,0.9}
\definecolor{lightgreen}{rgb}{0.8,0.95,0.8}

\def\a{Bla bla bla bla bla bla bla bla bla bla bla.}
\def\b{\a\a\a\a\a}

\begin{document}

\title{Testing Pygmen\TeX}
\author{JosÃ© Romildo}
\maketitle

\section{The Pygmen\TeX{} package}

This document demonstrates how to use the pygment\TeX{} package to typeset
code listings with \LaTeX{} and
Pygments\footnote{\url{http://pygments.org/}}.

Pygments is a generic syntax highlighter for general use in all kinds of
software such as forum systems, wikis or other applications that need to
prettify source code.

Pygmen\TeX{} provides an environment and two commands for typesetting code
listings in a \LaTeX{} document:
\begin{itemize}
  \item the \texttt{pygmented} environment typesets its contents,
  \item the \texttt{includepygmented} command typesets the contents of a
  file, including the result in the \LaTeX{} document, and
  \item the \texttt{pyginline} command typesets its contents, keeping
  the result in the same line.
\end{itemize}
They accept many options that allow the user to configure the listing in
many ways.

Read the remaining of this document to have an ided of what the package
is capable of.

\section{How to use the package}

In order to use the package, start by putting
\begin{verbatim}
\usepackage{pygmentex}
\end{verbatim}
in the preamble of the document.

Use the environment or commands mentioned previously to include source
listings on your document.

When compiling the document (with \texttt{pdflatex}, for instance), all
the source listings in the document wil be collected and saved in a
temporary file with the extension \texttt{.snippets} in its name. Then
the auxiliary program \texttt{pygmentex} (a Python application
distributed with the pygmen\TeX{} package) should be run taking this
file as input. It will produce another temporary file with the extension
\texttt{.pygmented} containing \LaTeX{} code for the code listings
previously collected. The next time the document is compiled, they are
included to produce the final typeset document.

\section{First example}

See listing \ref{lst:a} for an example.

\begin{Example}
\begin{pygmented}[boxing method=mdframed,
  lang=scheme,
  linenos,
  linenostart=1001,
  linenosep=2cm,
  colback=red!16,
  label=lst:a,
  caption=My \emph{first} examples.,
  frametitle=A \textbf{Scheme} program.,
  ]
(define fact
    (lambda (n)
        (if (= n 0)
            1
            (* n (fact (- n 1))))))

\end{pygmented}
\end{Example}

\begin{Example}
\begin{pygmented}[boxing method=tcolorbox,
  lang=scheme,
  linenos,
  linenostart=10001,
  linenosep=2cm,
  colback=green!16,
  label=lst:b,
  caption=My \emph{first} examples.,
  title=A \textbf{Scheme} program
  ]
(define fact
    (lambda (n)
        (if (= n 0)
            1
            (* n (fact (- n 1))))))
\end{pygmented}
\end{Example}

\begin{Example}
\begin{pygmented}[boxing method=boite,
  lang=scheme,
  linenos,
  linenostart=10001,
  linenosep=2cm,
  colback=yellow!16,
  label=lst:c,
  caption=My \emph{first} examples.,
  title=A \textbf{Scheme} program.,
  ]
(define fact
    (lambda (n)
        (if (= n 0)
            1
            (* n (fact (- n 1))))))
\end{pygmented}
\end{Example}


\section{Inline code snippets}

An inline source code snippet:
\pyginline[lang=c]|const double alfa = 3.14159;|
This is a C declaration with initialization.

\pyginline[lang=prolog,colback=yellow]=avo(A,B) :- pai(A,X), pai(X,B).=
is a Prolog clause. Its head is
\pyginline[lang=prolog,sty=emacs,colback=yellow,linecolor=red]=avo(A,B)=
and its body is
\pyginline[lang=prolog,sty=vim,colback=black,hidealllines]=pai(A,X), pai(X,B)=.

See the identifier
\pyginline[inline method=efbox,colback=green!25]|variable|, which names
something. String literals in C looks like
\pyginline[lang=c,inline method=tcbox,colback=blue!20,boxrule=2pt]|"hello, world!\n"|.

\setpygmented{colback=shadecolor}

This one
\pyginline[lang=ocaml,font=\ttfamily\scriptsize,topline=false]:let x = [1;2;3] in length x:
is an OCaml expression with local bindings. With OCaml one can do
imperative, functional and object oriented programming.

Now some Java code:
\pyginline[lang=java,sty=colorful,font=\ttfamily\itshape,linewidth=1pt]|public int f(double x)|.
This is a method header.

\section{Displayed code snippets}

\setpygmented{lang=scheme,colback=shadecolor,sty=emacs}

In listing \ref{lst:fact} you can see a function definition in the
Scheme language. This function computes the factorial of a natural
number.
\newline\rule{\linewidth}{2pt}
\begin{pygmented}[
  sty=emacs,
  linenos,
  label=lst:fact,
  caption=A Scheme function.
  ]
(define fact
    (lambda (n)
        (if (= n 0)
            1
            (* n (fact (- n 1))))))
\end{pygmented}

Here you have some more code to further testing the package. Listing
\ref{lst:haskell} is a Haskell program. When run this program interacts
with the user asking the user name, reading a line input by the user,
and showing a greeting message to the user.

\inputpygmented[%
  lang=haskell,
  linenos,
  linenostart=79831,
  innerlinecolor=yellow, innerlinewidth=6pt,
  middlelinecolor=blue, middlelinewidth=10pt,
  outerlinecolor=green, outerlinewidth=12pt,
  roundcorner=4,
  colback=shadecolor,
  caption=A haskell interactive program,
  label=lst:haskell,
  ]{demo.hs}

This is a rule:

\noindent\rule{\linewidth}{2pt}

Now a Pascal procedure:

\inputpygmented[
  lang=delphi,
  linewidth=1.5pt,
  font=\ttfamily\sffamily\large,
  colback=yellow
  ]{demo.delphi}
and a Pascal program
\inputpygmented[lang=pascal,linenos,linenostart=5801]{demo.pas}

A Python code snippet:

\inputpygmented[
  lang=python,
  sty=emacs,
  linenos,
  linenostep=3,
  linewidth=1pt,
  colback=lightgreen
  ]{demo.py}

\section{Escaping to \LaTeX{} in code snippets}

\begin{pygmented}[lang=c,sty=manni,escapeinside=||,
  % caption=Conditional command.
  ]
if (|\textit{condition}|)
  |\textit{command$_1$}|
else
  |\textit{command$_2$}|
\end{pygmented}


\section{Using code snippets in environments}

The following is a \textbf{description} environment.

\begin{description}
  \item[An item] \a
  \begin{pygmented}[lang=scala,colback=yellow,
    % title=Item A
    ]
def qsort(xs: List[Int]): List[Int] =
  xs match {
    case Nil =>
      Nil
    case pivot :: tail =>
      qsort(tail filter { _ < pivot }) :::
        pivot :: qsort(tail filter { _ >= pivot })
  }
  \end{pygmented}
  \b
  
  \item[Another item] \a
  \begin{pygmented}[lang=lua,colback=yellow]
--- Spawn a program.
-- @param cmd The command.
-- @param sn Enable startup-notification.
-- @param screen The screen where to spawn window.
-- @return The awesome.spawn return value.
function spawn(cmd, sn, screen)
    if cmd and cmd ~= "" then
        if sn == nil then sn = true end
        return capi.awesome.spawn(cmd, sn, screen or capi.mouse.screen)
    end
end
  \end{pygmented}
  \b
\end{description}

\section{A long program}

Here you can read the source code for a hand written lexical analyser
for the \emph{straight-line} programming language that I have developed
in Java.

\inputpygmented[boxing method=mdframed,lang=java,sty=autumn,colback=red!8,font=\ttfamily\small,tabsize=2,frametitle=\emph{Ad hoc} lexical analyser]{demo.java}

\section{Some fancy examples using \texttt{tcolorbox}}

The followig example uses \texttt{tcolorbox} to typeset the code
listing.

\newcounter{example}
\newlength{\examlen}
\colorlet{colexam}{red!75!black}

\begin{pygmented}[boxing method=tcolorbox,lang=scala,
  title=Example \arabic{example}: hello from \texttt{Scala},
  code={\refstepcounter{example}%
        \settowidth{\examlen}{\Large\bfseries Example \arabic{example}}},%
  coltitle=colexam,fonttitle=\Large\bfseries,
  enhanced,breakable,
  before=\par\medskip,
  parbox=false,
  frame hidden,interior hidden,segmentation hidden,
  boxsep=0pt,left=0pt,right=3mm,toptitle=2mm,pad at break=0mm,
  overlay unbroken={\draw[colexam,line width=1pt] (frame.north west)
    --([xshift=-0.5pt]frame.north east)--([xshift=-0.5pt]frame.south east)
    --(frame.south west);
    \draw[colexam,line width=2pt] ([yshift=0.5pt]frame.north west)
    -- +(\examlen,0pt);},
  overlay first={\draw[colexam,line width=1pt] (frame.north west)
    --([xshift=-0.5pt]frame.north east)--([xshift=-0.5pt]frame.south east);
    \draw[red!75!black,line width=2pt] ([yshift=0.5pt]frame.north west)
    -- +(\examlen,0pt);},
  overlay middle={\draw[colexam,line width=1pt] ([xshift=-0.5pt]frame.north east)
    --([xshift=-0.5pt]frame.south east); },
  overlay last={\draw[colexam,line width=1pt] ([xshift=-0.5pt]frame.north east)
    --([xshift=-0.5pt]frame.south east)--(frame.south west);}%
  ]
object HelloWorld extends App {
  println("Hello, world!")
}\end{pygmented}

\begin{pygmented}[boxing method=tcolorbox,lang=java,
  enhanced,colback=blue!10!white,colframe=orange,top=4mm,
  enlarge top by=\baselineskip/2+1mm,
  enlarge top at break by=0mm,pad at break=2mm,
  fontupper=\normalsize,
  overlay unbroken and first={%
    \node[rectangle,rounded corners,draw=black,fill=blue!20!white,
    inner sep=1mm,anchor=west,font=\small]
    at ([xshift=4.5mm]frame.north west) {\strut\textbf{My fancy title}};},
  ]
public class Hello {
  public static void main(String[] args) {
    System.out.println("Hello, world!")
  }
}
\end{pygmented}

\begin{pygmented}[boxing method=tcolorbox,lang=haskell,
  enhanced,sharp corners=uphill,
  colback=blue!25!white,colframe=blue!25!black,coltext=blue!90!black,
  fontupper=\Large\bfseries,arc=6mm,boxrule=2mm,boxsep=5mm,
  borderline={0.3mm}{0.3mm}{white}
  ]
module Main (main) where

main :: IO ()
main = putStrLn "Hello, world!"
\end{pygmented}

\begin{pygmented}[boxing method=tcolorbox,lang=c++,
  enhanced,frame style image=blueshade.png,
  opacityback=0.75,opacitybacktitle=0.25,
  colback=blue!5!white,colframe=blue!75!black,
  title=My title
  ]
#include <iostream>
using namespace std;
int main(int argc, char** argv) {
  cout << "Hello, world!" << endl;
  return 0;
}
\end{pygmented}

\begin{pygmented}[boxing method=tcolorbox,lang=d,
  enhanced,attach boxed title to top center={yshift=-3mm,yshifttext=-1mm},
  colback=blue!5!white,colframe=blue!75!black,colbacktitle=red!80!black,
  title=My title,fonttitle=\bfseries,
  boxed title style={size=small,colframe=red!50!black}
  ]
/* This program prints a
   hello world message
   to the console.  */
 
import std.stdio;
 
void main()
{
    writeln("Hello, World!");
}
\end{pygmented}


\section{Some fancy examples using \texttt{mdframed}}

The followig example uses \texttt{mdframed} to typeset the code listing.

\global\mdfdefinestyle{exampledefault}{%
  linecolor=red,linewidth=3pt,%
  leftmargin=1cm,rightmargin=1cm
}

\begin{pygmented}[boxing method=mdframed,lang=ada,style=exampledefault]
with Ada.Text_IO;
 
procedure Hello_World is
 use Ada.Text_IO;
begin
    Put_Line("Hello, world!");
end;
\end{pygmented}

\global\mdfapptodefinestyle{exampledefault}{%
  topline=false,bottomline=false,
}

\begin{pygmented}[boxing method=mdframed,lang=pascal,style=exampledefault,frametitle={Saying \emph{hello} from Pascal}]
program HelloWorld;
 
begin
  WriteLn('Hello, world!');
end.
\end{pygmented}

\global\mdfdefinestyle{separateheader}{%
  frametitle={%
    \tikz[baseline=(current bounding box.east),outer sep=0pt]
    \node[anchor=east,rectangle,fill=blue!20]
    {\strut Saying \emph{hello} em Eiffel};},
  innertopmargin=10pt,linecolor=blue!20,%
  linewidth=2pt,topline=true,
  frametitleaboveskip=\dimexpr-\ht\strutbox\relax,
  frametitlerule=false,
  backgroundcolor=white,
}

\begin{pygmented}[boxing method=mdframed,lang=eiffel,style=separateheader]
class
    HELLO_WORLD
create
    make
feature
    make
        do
            print ("Hello, world!%N")
        end
end
\end{pygmented}


\tikzset{titregris/.style =
     {draw=gray, thick, fill=white, shading = exersicetitle, %
      text=gray, rectangle, rounded corners, right,minimum height=.7cm}}
\pgfdeclarehorizontalshading{exersicebackground}{100bp}
          {color(0bp)=(green!40); color(100bp)=(black!5)}
\pgfdeclarehorizontalshading{exersicetitle}{100bp}
          {color(0bp)=(red!40);color(100bp)=(black!5)}
\newcounter{exercise}
\renewcommand*\theexercise{Exercise~n\arabic{exercise}}
\makeatletter
\def\mdf@@exercisepoints{}%new mdframed key:
\define@key{mdf}{exercisepoints}{%
    \def\mdf@@exercisepoints{#1}
}
\mdfdefinestyle{exercisestyle}{%
  outerlinewidth=1em,outerlinecolor=white,%
  leftmargin=-1em,rightmargin=-1em,%
  middlelinewidth=1.2pt,roundcorner=5pt,linecolor=gray,
  apptotikzsetting={\tikzset{mdfbackground/.append style ={%
                       shading = exersicebackground}}},
  innertopmargin=1.2\baselineskip,
  skipabove={\dimexpr0.5\baselineskip+\topskip\relax},
  skipbelow={-1em},
  needspace=3\baselineskip,
  frametitlefont=\sffamily\bfseries,
  settings={\global\stepcounter{exercise}},
  singleextra={%
      \node[titregris,xshift=1cm] at (P-|O) %
         {~\mdf@frametitlefont{\theexercise}\hbox{~}};
      \ifdefempty{\mdf@@exercisepoints}%
      {}%
      {\node[titregris,left,xshift=-1cm] at (P)%
        {~\mdf@frametitlefont{\mdf@@exercisepoints points}\hbox{~}};}%
   },
  firstextra={%
      \node[titregris,xshift=1cm] at (P-|O) %
         {~\mdf@frametitlefont{\theexercise}\hbox{~}};
      \ifdefempty{\mdf@@exercisepoints}%
      {}%
      {\node[titregris,left,xshift=-1cm] at (P)%
        {~\mdf@frametitlefont{\mdf@@exercisepoints points}\hbox{~}};}%
   },
}
\makeatother

\begin{pygmented}[boxing method=mdframed,lang=go,style=exercisestyle]
// hello world in 'go'
package main
 
import "fmt"
 
func main() {
   fmt.Println("Hello, world!")
}
\end{pygmented}

\begin{pygmented}[boxing method=mdframed,lang=objective-c,style=exercisestyle,exercisepoints=10]
/* hello from objective-c */

#import <stdio.h>
#import <Foundation/Foundation.h>
 
int main(void)
{
    NSLog(@"Hello, world!\n");
    return 0;
}
\end{pygmented}

\mdfdefinestyle{another}{%
  linecolor=red,middlelinewidth=2pt,%
  frametitlerule=true,%
  apptotikzsetting={\tikzset{mdfframetitlebackground/.append style={%
        shade,left color=white, right color=blue!20}}},
  frametitlerulecolor=green!60,
  frametitlerulewidth=1pt,
  innertopmargin=\topskip,
}

\begin{pygmented}[boxing method=mdframed,lang=c,style=another,frametitle={Hello from C}]
#include <stdio.h>
int main(int argc, char **argv) {
  printf("Hello, world!\n");
  return 0;
}
\end{pygmented}



\section{Conclusion}

That is all.


\end{document}
